<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ğŸ§˜ Tu TiÃªn RPG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: radial-gradient(circle at top, #1b2233, #05080f);
  color: #fff;
}

button {
  width: 100%;
  padding: 12px;
  margin: 6px 0;
  font-size: 16px;
  border-radius: 10px;
  border: none;
  background: linear-gradient(135deg,#3b82f6,#2563eb);
  color: white;
}

button.red { background: linear-gradient(135deg,#ef4444,#b91c1c); }
button.green { background: linear-gradient(135deg,#22c55e,#15803d); }

.panel {
  background: rgba(255,255,255,0.06);
  border-radius: 16px;
  padding: 14px;
  margin: 12px;
}

.small {
  font-size: 14px;
  max-height: 160px;
  overflow-y: auto;
}

.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
}

.box {
  background: #0f172a;
  padding: 20px;
  border-radius: 16px;
  width: 90%;
  max-width: 380px;
}

input, select {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  border-radius: 8px;
  border: none;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen" class="overlay">
  <div class="box">
    <h2>ğŸ” ÄÄƒng nháº­p</h2>
    <input id="loginUser" placeholder="TÃ i khoáº£n">
    <input id="loginPass" type="password" placeholder="Máº­t kháº©u">
    <button onclick="login()">ÄÄƒng nháº­p</button>
  </div>
</div>

<!-- CREATE CHARACTER -->
<div id="createScreen" class="overlay" style="display:none">
  <div class="box">
    <h2>ğŸ² Táº¡o nhÃ¢n váº­t</h2>
    <input id="charName" placeholder="TÃªn nhÃ¢n váº­t">
    <select id="gender">
      <option>Nam</option>
      <option>Ná»¯</option>
    </select>

    <p>ğŸŒ± Linh cÄƒn: <b id="linhCan"></b></p>
    <p>âœ¨ TiÃªn thiÃªn:</p>
    <ul id="tienThienList"></ul>

    <button class="green" onclick="roll()">ğŸ² Roll láº¡i</button>
    <button onclick="confirmChar()">âœ… XÃ¡c nháº­n</button>
  </div>
</div>

<!-- GAME -->
<div id="game" style="display:none">
  <h2 style="text-align:center">ğŸ§˜ Tu TiÃªn RPG</h2>

  <div class="panel" id="charInfo"></div>

  <div class="panel">
    <div>âš¡ Linh khÃ­: <span id="qi">0</span>/100</div>
    <div>â¤ï¸ HP: <span id="hp">100</span></div>
  </div>

  <div class="panel">
    <button onclick="startCultivation()">ğŸ§˜ Báº¯t Ä‘áº§u tu luyá»‡n</button>
    <button onclick="stopCultivation()">â¸ Dá»«ng</button>
    <button onclick="openCombat()">âš”ï¸ Chiáº¿n Ä‘áº¥u</button>
  </div>

  <div class="panel small" id="log"></div>
</div>

<!-- COMBAT -->
<div id="combatScreen" class="overlay" style="display:none">
  <div class="box">
    <canvas id="combatCanvas" width="300" height="160"
      style="background:#020617;border-radius:12px"></canvas>
    <button onclick="playerAttack()">ğŸ—¡ï¸ ÄÃ¡nh</button>
    <button class="red" onclick="endCombat()">ğŸƒ RÃºt lui</button>
  </div>
</div>

<script>
/* ===== DATA ===== */
const linhCans = ["Kim","Má»™c","Thá»§y","Há»a","Thá»•","LÃ´i","BÄƒng","Ã‚m","DÆ°Æ¡ng"];
const tienThiens = [
  "ThiÃªn má»‡nh chi tá»­","NgÆ°á»i xuyÃªn khÃ´ng","Linh há»“n cÆ°á»ng Ä‘áº¡i",
  "KhÃ­ váº­n Ä‘en Ä‘á»§i","Äáº¡o tÃ¢m kiÃªn Ä‘á»‹nh","Huyáº¿t máº¡ch cá»• xÆ°a",
  "Ngá»™ tÃ­nh siÃªu phÃ m","Trá»i ghÃ©t Ä‘áº¥t ghÃ©t"
];

let player = null;
let cultiTimer = null;
let enemy = null;

/* ===== LOGIN ===== */
function login(){
  document.getElementById("loginScreen").style.display="none";
  document.getElementById("createScreen").style.display="flex";
  roll();
}

/* ===== CREATE ===== */
function roll(){
  document.getElementById("linhCan").innerText =
    linhCans[Math.floor(Math.random()*linhCans.length)];

  const list = document.getElementById("tienThienList");
  list.innerHTML="";
  [...tienThiens].sort(()=>0.5-Math.random()).slice(0,3)
    .forEach(t=>{
      const li=document.createElement("li");
      li.innerText=t;
      list.appendChild(li);
    });
}

function confirmChar(){
  player={
    name:charName.value||"VÃ´ danh",
    gender:gender.value,
    linhCan:linhCan.innerText,
    tienThien:[...tienThienList.children].map(li=>li.innerText),
    qi:0,
    hp:100
  };
  createScreen.style.display="none";
  game.style.display="block";
  render();
}

/* ===== GAME ===== */
function render(){
  charInfo.innerHTML=`
ğŸ‘¤ ${player.name} (${player.gender})<br>
ğŸŒ± ${player.linhCan}<br>
âœ¨ ${player.tienThien.join(", ")}
`;
  qi.innerText=player.qi;
  hp.innerText=player.hp;
}

function log(msg){
  logDiv=document.getElementById("log");
  logDiv.innerHTML+=msg+"<br>";
  logDiv.scrollTop=9999;
}

function startCultivation(){
  if(cultiTimer) return;
  log("ğŸ§˜ Báº¯t Ä‘áº§u tu luyá»‡n...");
  cultiTimer=setInterval(()=>{
    player.qi++;
    if(player.qi>=100){
      player.qi=100;
      stopCultivation();
      log("âš¡ Linh khÃ­ Ä‘áº§y!");
    }
    render();
  },500);
}

function stopCultivation(){
  clearInterval(cultiTimer);
  cultiTimer=null;
}

/* ===== COMBAT ===== */
function openCombat(){
  combatScreen.style.display="flex";
  enemy={name:"YÃªu thÃº",hp:40,atk:6};
  drawCombat();
  log("âš”ï¸ Gáº·p YÃªu thÃº!");
}

function playerAttack(){
  enemy.hp-=10;
  log("ğŸ—¡ï¸ Báº¡n Ä‘Ã¡nh YÃªu thÃº");
  if(enemy.hp<=0){
    log("ğŸ‰ Chiáº¿n tháº¯ng!");
    endCombat();
    return;
  }
  setTimeout(()=>{
    player.hp-=enemy.atk;
    log("ğŸ’¥ YÃªu thÃº pháº£n cÃ´ng");
    if(player.hp<=0){
      log("â˜ ï¸ Báº¡n báº¡i tráº­n!");
      endCombat();
    }
    render();
    drawCombat();
  },500);
}

function endCombat(){
  combatScreen.style.display="none";
  enemy=null;
}

function drawCombat(){
  const c=combatCanvas;
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  ctx.fillStyle="cyan";
  ctx.fillRect(30,80,30,30);
  ctx.fillStyle="red";
  ctx.fillRect(220,80,30,30);
}
</script>

</body>
</html>
